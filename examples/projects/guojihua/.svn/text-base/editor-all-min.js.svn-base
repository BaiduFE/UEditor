var baidu=baidu||{};baidu.editor=baidu.editor||{};baidu.editor.commands={};baidu.editor.plugins={};baidu.editor.browser=function(){var d=navigator.userAgent.toLowerCase(),b=window.opera,c={ie:!!window.ActiveXObject,opera:(!!b&&b.version),webkit:(d.indexOf(" applewebkit/")>-1),air:(d.indexOf(" adobeair/")>-1),mac:(d.indexOf("macintosh")>-1),quirks:(document.compatMode=="BackCompat")};c.gecko=(navigator.product=="Gecko"&&!c.webkit&&!c.opera);var a=0;if(c.ie){a=parseFloat(d.match(/msie (\d+)/)[1]);c.ie8=!!document.documentMode;c.ie8Compat=document.documentMode==8;c.ie7Compat=((a==7&&!document.documentMode)||document.documentMode==7);c.ie6Compat=(a<7||c.quirks)}if(c.gecko){var e=d.match(/rv:([\d\.]+)/);if(e){e=e[1].split(".");a=e[0]*10000+(e[1]||0)*100+(e[2]||0)*1}}if(c.opera){a=parseFloat(b.version())}if(c.webkit){a=parseFloat(d.match(/ applewebkit\/(\d+)/)[1])}c.version=a;c.isCompatible=!c.mobile&&((c.ie&&a>=6)||(c.gecko&&a>=10801)||(c.opera&&a>=9.5)||(c.air&&a>=1)||(c.webkit&&a>=522)||false);return c}();(function(){var b=new Function();var a=baidu.editor.utils={makeInstance:function(c){b.prototype=c;c=new b;b.prototype=null;return c},isArray:function(c){return c&&c.constructor===Array},each:function(f,e,g){if(a.isArray(f)){for(var d=0;d<f.length;d++){e.call(g,f[d],d,f)}}else{for(var c in f){e.call(g,f[c],c,f)}}},inherits:function(f,d){var c=f.prototype;var e=a.makeInstance(d.prototype);a.extend(e,c,true);f.prototype=e;return(e.constructor=f)},bind:function(c,d){return function(){return c.apply(d,arguments)}},defer:function(d,c,e){var f;return function(){if(e){clearTimeout(f)}f=setTimeout(d,c)}},extend:function(e,f,c){if(f){for(var d in f){if(!c||!e.hasOwnProperty(d)){e[d]=f[d]}}}return e},indexOf:function(e,d,c){c=c||0;while(c<e.length){if(e[c]===d){return c}c++}return -1},removeItem:function(e,d){var c=e.length;if(c){while(c--){if(e[c]===d){e.splice(c,1);break}}}},trim:function(){var c=/(^[ \t\n\r]+)|([ \t\n\r]+$)/g;return function(d){return d.replace(c,"")}}(),listToMap:function(d){if(!d){return{}}var f=d.split(/,/g),c=f.length,e={};if(c){while(c--){e[f[c]]=1}}return e},unhtml:function(){var d={"<":"&lt;","&":"&amp",'"':"&quot;",">":"&gt;"};function c(e){return d[e]}return function(e){return e?e.replace(/[&<">]/g,c):""}}(),cssStyleToDomStyle:function(){var f=document.createElement("div").style,d=f.cssFloat!=undefined?"cssFloat":f.styleFloat!=undefined?"styleFloat":"float",c={"float":d};function e(g){return g.charAt(1).toUpperCase()}return function(g){return c[g]||(c[g]=g.toLowerCase().replace(/-./g,e))}}()}})();(function(){baidu.editor.EventBase=c;var a=baidu.editor.utils;function c(){}c.prototype={addListener:function(d,e){b(this,d.toLowerCase(),true).push(e)},removeListener:function(e,f){var d=b(this,e);d&&a.removeItem(d,f)},fireEvent:function(g){var f=b(this,g),h,e,d;if(f){d=f.length;while(d--){e=f[d].apply(this,arguments);if(e!==undefined){h=e}}}if(e=this["on"+g.toLowerCase()]){h=e.apply(this,arguments)}return h}};function b(g,e,f){var d;return((d=(g.__allListeners||f&&(g.__allListeners={})))&&(d[e]||f&&(d[e]=[])))}})();baidu.editor.dom=baidu.editor.dom||{};baidu.editor.dom.dtd=(function(){function y(A){for(var z in A){A[z.toUpperCase()]=A[z]}return A}function a(D){var A=arguments;for(var C=1;C<A.length;C++){var z=A[C];for(var B in z){if(!D.hasOwnProperty(B)){D[B]=z[B]}}}return D}var x=y({isindex:1,fieldset:1}),w=y({input:1,button:1,select:1,textarea:1,label:1}),v=a(y({a:0}),w),u=a({iframe:1},v),t=y({hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1}),s=y({ins:1,del:1,script:1,style:1}),r=a(y({b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1}),s),q=a(y({sub:1,img:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1}),r),p=a(y({p:1}),q),o=a(y({iframe:1}),q,w),n=y({img:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1}),m=a(y({a:1}),o),k=y({tr:1}),j=y({"#":1}),i=a(y({param:1}),n),h=a(y({form:1}),x,u,t,p),g=y({li:1}),f=y({style:1,script:1}),e=y({base:1,link:1,meta:1,title:1}),d=a(e,f),c=y({head:1,body:1}),b=y({html:1});var l=y({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1});return y({$nonBodyContent:a(b,c,e),$block:l,$inline:m,$body:a(y({script:1,style:1}),l),$cdata:y({script:1,style:1}),$empty:y({area:1,base:1,br:1,col:1,hr:1,img:1,input:1,link:1,meta:1,param:1}),$listItem:y({dd:1,dt:1,li:1}),$list:y({ul:1,ol:1,dl:1}),$removeEmpty:y({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1}),$tableContent:y({caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1}),html:c,head:d,style:j,script:j,body:h,base:{},link:{},meta:{},title:j,col:{},tr:y({td:1,th:1}),img:{},colgroup:y({col:1}),noscript:h,td:h,br:{},th:h,center:h,kbd:m,button:a(p,t),basefont:{},h5:m,h4:m,samp:m,h6:m,ol:g,h1:m,h3:m,option:j,h2:m,form:a(x,u,t,p),select:y({optgroup:1,option:1}),font:m,ins:m,menu:g,abbr:m,label:m,table:y({thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1}),code:m,tfoot:k,cite:m,li:h,input:{},iframe:h,strong:m,textarea:j,noframes:h,big:m,small:m,span:baidu.editor.utils.extend(m,{A:0,a:0}),hr:m,dt:m,sub:m,optgroup:y({option:1}),param:{},bdo:m,"var":m,div:h,object:i,sup:m,dd:h,strike:m,area:{},dir:g,map:a(y({area:1,form:1,p:1}),x,s,t),applet:i,dl:y({dt:1,dd:1}),del:m,isindex:{},fieldset:a(y({legend:1}),n),thead:k,ul:g,acronym:m,b:m,a:a(y({a:1}),o),blockquote:a(y({td:1,tr:1,tbody:1,li:1}),h),caption:m,i:m,u:{},tbody:k,s:m,address:a(u,p),tt:m,legend:m,q:m,pre:a(r,v),p:m,em:m,dfn:m})})();(function(){var e=baidu.editor,d=e.browser,f=e.dom.dtd,c=e.utils,b;function g(n,o,i,h,l,m){var k=h&&n[o],j;!k&&(k=n[i]);while(!k&&(j=(j||n).parentNode)){if(j.tagName=="BODY"){return null}if(m&&!m(j)){return null}k=j[i]}if(k&&l&&!l(k)){return g(k,o,i,false,l)}return k}var a=baidu.editor.dom.domUtils={NODE_ELEMENT:1,NODE_DOCUMENT:9,NODE_TEXT:3,NODE_COMMENT:8,NODE_DOCUMENT_FRAGMENT:11,POSITION_IDENTICAL:0,POSITION_DISCONNECTED:1,POSITION_FOLLOWING:2,POSITION_PRECEDING:4,POSITION_IS_CONTAINED:8,POSITION_CONTAINS:16,fillChar:d.ie&&d.version=="6"?"\ufeff":"\u200B",getPosition:function(n,l){if(n===l){return 0}if(d.gecko){return n.compareDocumentPosition(l)}var j,m=[n],k=[l];j=n;while(j=j.parentNode){if(j===l){return 10}m.push(j)}j=l;while(j=j.parentNode){if(j===n){return 20}k.push(j)}m.reverse();k.reverse();if(m[0]!==k[0]){return 1}var h=-1;while(h++,m[h]===k[h]){}n=m[h];l=k[h];while(n=n.nextSibling){if(n===l){return 4}}return 2},getNodeIndex:function(j){var k=j.parentNode.childNodes,h=0;while(k[h]!==j){h++}return h},findParent:function(i,h){if(!this.isBody(i)){i=i.parentNode;while(i){if(!h||h(i)||this.isBody(i)){return h&&!h(i)&&this.isBody(i)?null:i}i=i.parentNode}}return null},findParentByTagName:function(j,i,h){if(j&&j.nodeType&&!this.isBody(j)&&(j.nodeType==1||j.nodeType)){i=!c.isArray(i)?[i]:i;j=j.nodeType==3||!h?j.parentNode:j;while(j&&j.nodeType!=9){if(c.indexOf(i,j.tagName.toLowerCase())>-1){return j}j=j.parentNode}}return null},findParents:function(l,k,h,j){var i=k&&(h&&h(l)||!h)?[l]:[];while(l=a.findParent(l,h)){i.push(l)}if(!j){i.reverse()}return i},insertAfter:function(i,h){return i.parentNode.insertBefore(h,i.nextSibling)},remove:function(i,j){var h=i.parentNode,k;if(h){if(j&&i.hasChildNodes()){while(k=i.firstChild){h.insertBefore(k,i)}}h.removeChild(i)}return i},getNextDomNode:function(k,h,i,j){return g(k,"firstChild","nextSibling",h,i,j)},getPreviousDomNode:function(j,h,i){return g(j,"lastChild","previousSibling",h,i)},isBookmarkNode:function(h){return h.nodeType==1&&h.id&&/^_baidu_bookmark_/i.test(h.id)},getWindow:function(h){var i=h.ownerDocument||h;return i.defaultView||i.parentWindow},getCommonAncestor:function(n,l){if(n===l){return n}var m=[n],k=[l],j=n,h=-1;while(j=j.parentNode){if(j===l){return j}m.push(j)}j=l;while(j=j.parentNode){if(j===n){return j}k.push(j)}m.reverse();k.reverse();while(h++,m[h]===k[h]){}return h==0?null:m[h-1]},clearEmptySibling:function(k,i,j){function h(n,l){var m;if(n&&(!a.isBookmarkNode(n)&&a.isEmptyInlineElement(n)||a.isWhitespace(n))){m=n[l];a.remove(n);m&&h(m,l)}}!i&&h(k.nextSibling,"nextSibling");!j&&h(k.previousSibling,"previousSibling")},split:function(k,m){var l=k.ownerDocument;if(d.ie&&m==k.nodeValue.length){var j=l.createTextNode("");return a.insertAfter(k,j)}var h=k.splitText(m);if(d.ie8){var i=l.createTextNode("");a.insertAfter(h,i);a.remove(i)}return h},isWhitespace:function(i){var h=new RegExp("[^ \t\n\r"+a.fillChar+"]");return !h.test(i.nodeValue)},getXY:function(h){var i=h.getBoundingClientRect();return{x:Math.round(i.left),y:Math.round(i.top)}},on:function(m,l,j){var i=l instanceof Array?l:[l],h=i.length;if(h){while(h--){l=i[h];if(m.addEventListener){m.addEventListener(l,j,false)}else{m.attachEvent("on"+l,j)}}}},un:function(m,l,j){var i=l instanceof Array?l:[l],h=i.length;if(h){while(h--){l=i[h];if(m.removeEventListener){m.removeEventListener(l,j,false)}else{m.detachEvent("on"+l,j)}}}},isSameElement:function(i,h){if(i.tagName!=h.tagName){return false}var p=i.attributes,n=h.attributes;if(!d.ie&&p.length!=n.length){return false}var j=p.length,q=0;if(j){while(j--){var o=p[j];if(!d.ie||o.specified){q++;if(o.nodeName=="style"){continue}var m=h.attributes[o.nodeName];var l=m&&m.nodeValue||null;if(l!=o.nodeValue){return false}}}}if(!a.isSameStyle(i,h)){return false}if(d.ie){j=n.length;if(j){while(j--){if(n[j].specified){q--}}}return !q}return true},isRedundantSpan:function(l){if(l.nodeType==3||l.tagName.toLowerCase()!="span"){return 0}if(d.ie){var j=l.attributes;if(j.length){for(var k=0,h;h=j[k++];){if(h.specified){return 0}}return 1}}return !l.attributes.length},isSameStyle:function(l,k){var j=l.style.cssText,h=k.style.cssText;if(!j&&!h){return true}else{if(!j||!h){return false}}var o={},i=[],m={};j.replace(/[\w-]+\s*(?=:)/g,function(p){o[p]=i.push(p)});try{h.replace(/[\w-]+\s*(?=:)/g,function(q){var p=o[q];if(p){q=c.cssStyleToDomStyle(q);if(l.style[q]!==k.style[q]){throw m}i[p-1]=""}else{throw m}})}catch(n){if(n===m){return false}}return !i.join("")},isBlockElm:function(){var i=["block","list-item","table","table-row-group","table-header-group","table-footer-group","table-row","table-column-group","table-column","table-cell","table-caption"],h={hr:1};return function(k,j){return k.nodeType==1&&(c.indexOf(i,a.getComputedStyle(k,"display"))!=-1||c.extend(h,j||{})[k.tagName.toLocaleLowerCase()])}}(),isBody:function(h){return h&&h.nodeType==1&&h.tagName.toLowerCase()=="body"},breakParent:function(l,j){var i,n=l,m=l,h,k;do{n=n.parentNode;if(h){i=n.cloneNode(false);i.appendChild(h);h=i;i=n.cloneNode(false);i.appendChild(k);k=i}else{h=n.cloneNode(false);k=h.cloneNode(false)}while(i=m.previousSibling){h.insertBefore(i,h.firstChild)}while(i=m.nextSibling){k.appendChild(i)}m=n}while(j!==n);i=j.parentNode;i.insertBefore(h,j);i.insertBefore(k,j);i.insertBefore(l,k);a.remove(j);return l},isEmptyInlineElement:function(h){if(h.nodeType!=1||!f.$removeEmpty[h.tagName]){return 0}h=h.firstChild;while(h){if(a.isBookmarkNode(h)){return 0}if(h.nodeType==1&&!a.isEmptyInlineElement(h)||h.nodeType==3&&!a.isWhitespace(h)){return 0}h=h.nextSibling}return 1},trimWhiteTextNode:function(i){function h(j){var k;while((k=i[j])&&k.nodeType==3&&a.isWhitespace(k)){i.removeChild(k)}}h("firstChild");h("lastChild")},mergChild:function(k){var l=a.getElementsByTagName(k,k.tagName.toLowerCase());for(var j=0,h;h=l[j++];){if(!h.parentNode||a.isBookmarkNode(h)){continue}if(h.tagName.toLowerCase()=="span"){if(k===h.parentNode){a.trimWhiteTextNode(k);if(k.childNodes.length==1){k.style.cssText=h.style.cssText+";"+k.style.cssText;a.remove(h,true);continue}}h.style.cssText=h.style.cssText+";"+k.style.cssText;if(h.style.cssText==k.style.cssText){a.remove(h,true)}continue}if(a.isSameElement(k,h)){a.remove(h,true)}}},getElementsByTagName:function(m,j){var n=m.getElementsByTagName(j),h=[];for(var l=0,k;k=n[l++];){h.push(k)}return h},mergToParent:function(i){var h=i.parentNode;while(h&&f.$removeEmpty[h.tagName]){if(h.tagName==i.tagName){a.trimWhiteTextNode(h);if(h.tagName.toLowerCase()=="span"&&!a.isSameStyle(h,i)){if(h.childNodes.length>1||h!==i.parentNode){i.style.cssText=h.style.cssText+";"+i.style.cssText;h=h.parentNode;continue}else{h.style.cssText+=";"+i.style.cssText}}a.remove(i,true)}h=h.parentNode}},mergSibling:function(j,i,h){function k(n,o,m){var l;if((l=m[n])&&!a.isBookmarkNode(l)&&l.nodeType==1&&a.isSameElement(m,l)){while(l.firstChild){if(o=="firstChild"){m.insertBefore(l.lastChild,m.firstChild)}else{m.appendChild(l.firstChild)}}a.remove(l)}}!i&&k("previousSibling","firstChild",j);!h&&k("nextSibling","lastChild",j)},unselectable:d.gecko?function(h){h.style.MozUserSelect="none"}:d.webkit?function(h){h.style.KhtmlUserSelect="none"}:function(k){k.unselectable="on";for(var j=0,h;h=k.all[j++];){switch(h.tagName.toLowerCase()){case"iframe":case"textarea":case"input":case"select":break;default:h.unselectable="on"}}},removeAttributes:function(i,j){var h=j.length;if(h){while(h--){i.removeAttribute(j[h])}}},setAttributes:function(j,i){for(var h in i){switch(h){case"class":j.className=i[h];break;case"style":j.style.cssText=i[h];break;default:j.setAttribute(h,i[h])}}return j},getComputedStyle:function(){function h(i,j){if(i=="font-size"&&/px$/.test(j)){j=Math.round(parseFloat(j)*0.75)+"pt"}return j}if(window.getComputedStyle){return function(j,i){return h(i,a.getWindow(j).getComputedStyle(j,"").getPropertyValue(i))}}return function(j,i){return h(i,(j.currentStyle||j.style)[c.cssStyleToDomStyle(i)])}}(),removeClasses:function(h,i){h.className=h.className.replace(new RegExp("(?:\\s*\\b)(?:"+i.join("|")+")(?:\\b)","g"),"")},removeStyle:function(i,h){i.style[c.cssStyleToDomStyle(h)]="";if(i.style.removeAttribute){i.style.removeAttribute(c.cssStyleToDomStyle(h))}if(!i.style.cssText){i.removeAttribute("style")}},hasClass:function(h,i){return(" "+h.className+" ").indexOf(" "+i+" ")>-1},preventDefault:function(h){if(h.preventDefault){h.preventDefault()}else{h.returnValue=false}},getStyle:function(l,j){var m=l.style[c.cssStyleToDomStyle(j)];if(/color/i.test(j)&&m.indexOf("rgb(")!=-1){var n=m.split(",");m="#";for(var k=0,h;h=n[k];k++){h=parseInt(h.replace(/[^\d]/gi,""),10).toString(16);m+=h.length==1?"0"+h:h}m=m.toUpperCase()}return m},removeDirtyAttr:function(l){for(var k=0,j,h=l.getElementsByTagName("*");j=h[k++];){j.removeAttribute("_moz_dirty")}l.removeAttribute("_moz_dirty")},getChildCount:function(j,h){var i=0,k=j.firstChild;h=h||function(){return 1};while(k){if(h(k)){i++}k=k.nextSibling}return i}}})();(function(){var g=baidu.editor,f=g.browser,e=g.dom.domUtils,a=g.dom.dtd,j=g.utils,h=0,i=e.fillChar;var c=function(l){l.collapsed=l.startContainer&&l.endContainer&&l.startContainer===l.endContainer&&l.startOffset==l.endOffset},b=function(m,n,o,l){if(n.nodeType==1&&a.$empty[n.tagName.toLowerCase()]){o=e.getNodeIndex(n)+(m?0:1);n=n.parentNode}if(m){l.startContainer=n;l.startOffset=o;if(!l.endContainer){l.collapse(true)}}else{l.endContainer=n;l.endOffset=o;if(!l.startContainer){l.collapse(false)}}c(l);return l},k=function(r,v){var p=r.startContainer,o=r.endContainer,x=r.startOffset,q=r.endOffset,D=r.document,l=D.createDocumentFragment(),s,u;if(p.nodeType==1){p=p.childNodes[x]||(s=p.appendChild(D.createTextNode("")))}if(o.nodeType==1){o=o.childNodes[q]||(u=o.appendChild(D.createTextNode("")))}if(p===o&&p.nodeType==3){l.appendChild(D.createTextNode(p.substringData(x,q-x)));if(v){p.deleteData(x,q-x);r.collapse(true)}return l}var t,z,B=l,A=e.findParents(p,true),m=e.findParents(o,true);for(var y=0;A[y]==m[y];y++){}for(var w=y,C;C=A[w];w++){t=C.nextSibling;if(C==p){if(!s){if(r.startContainer.nodeType==3){B.appendChild(D.createTextNode(p.nodeValue.slice(x)));if(v){p.deleteData(x,p.nodeValue.length-x)}}else{B.appendChild(!v?p.cloneNode(true):p)}}}else{z=C.cloneNode(false);B.appendChild(z)}while(t){if(t===o||t===m[w]){break}C=t.nextSibling;B.appendChild(!v?t.cloneNode(true):t);t=C}B=z}B=l;if(!A[y]){B.appendChild(A[y-1].cloneNode(false));B=B.firstChild}for(var w=y,n;n=m[w];w++){t=n.previousSibling;if(n==o){if(!u&&r.endContainer.nodeType==3){B.appendChild(D.createTextNode(o.substringData(0,q)));if(v){o.deleteData(0,q)}}}else{z=n.cloneNode(false);B.appendChild(z)}if(w!=y||!A[y]){while(t){if(t===p){break}n=t.previousSibling;B.insertBefore(!v?t.cloneNode(true):t,B.firstChild);t=n}}B=z}if(v){r.setStartBefore(!m[y]?m[y-1]:!A[y]?A[y-1]:m[y]).collapse(true)}s&&e.remove(s);u&&e.remove(u);return l};var d=baidu.editor.dom.Range=function(l){var m=this;m.startContainer=m.startOffset=m.endContainer=m.endOffset=null;m.document=l;m.collapsed=true};d.prototype={cloneContents:function(){return this.collapsed?null:k(this,0)},deleteContents:function(){if(!this.collapsed){k(this,1)}return this},extractContents:function(){return this.collapsed?null:k(this,2)},setStart:function(l,m){return b(true,l,m,this)},setEnd:function(l,m){return b(false,l,m,this)},setStartAfter:function(l){return this.setStart(l.parentNode,e.getNodeIndex(l)+1)},setStartBefore:function(l){return this.setStart(l.parentNode,e.getNodeIndex(l))},setEndAfter:function(l){return this.setEnd(l.parentNode,e.getNodeIndex(l)+1)},setEndBefore:function(l){return this.setEnd(l.parentNode,e.getNodeIndex(l))},selectNode:function(l){return this.setStartBefore(l).setEndAfter(l)},selectNodeContents:function(l){return this.setStart(l,0).setEnd(l,l.nodeType==3?l.nodeValue.length:l.childNodes.length)},cloneRange:function(){var m=this,l=new d(m.document);return l.setStart(m.startContainer,m.startOffset).setEnd(m.endContainer,m.endOffset)},collapse:function(l){var m=this;if(l){m.endContainer=m.startContainer;m.endOffset=m.startOffset}else{m.startContainer=m.endContainer;m.startOffset=m.endOffset}m.collapsed=true;return m},shrinkBoundary:function(m){var l=this,o,n=l.collapsed;while(l.startContainer.nodeType==1&&(o=l.startContainer.childNodes[l.startOffset])&&o.nodeType==1&&!e.isBookmarkNode(o)&&!a.$empty[o.tagName]){l.setStart(o,0)}if(n){return l.collapse(true)}if(!m){while(l.endContainer.nodeType==1&&l.endOffset>0&&(o=l.endContainer.childNodes[l.endOffset-1])&&o.nodeType==1&&!e.isBookmarkNode(o)&&!a.$empty[o.tagName]){l.setEnd(o,o.childNodes.length)}}return l},getCommonAncestor:function(m,n){var o=this.startContainer,l=this.endContainer;if(o===l){if(m&&o.nodeType==1&&this.startOffset==this.endOffset-1){return o.childNodes[this.startOffset]}return n&&o.nodeType==3?o.parentNode:o}return e.getCommonAncestor(o,l)},trimBoundary:function(m){this.txtToElmBoundary();var q=this.startContainer,p=this.startOffset,o=this.collapsed,l=this.endContainer;if(q.nodeType==3){if(p==0){this.setStartBefore(q)}else{if(p>=q.nodeValue.length){this.setStartAfter(q)}else{var n=e.split(q,p);if(q===l){this.setEnd(n,this.endOffset-p)}else{if(q.parentNode===l){this.endOffset+=1}}this.setStartBefore(n)}}if(o){return this.collapse(true)}}if(!m){p=this.endOffset;l=this.endContainer;if(l.nodeType==3){if(p==0){this.setEndBefore(l)}else{if(p>=l.nodeValue.length){this.setEndAfter(l)}else{e.split(l,p);this.setEndAfter(l)}}}}return this},txtToElmBoundary:function(){function l(n,p){var m=n[p+"Container"],o=n[p+"Offset"];if(m.nodeType==3){if(!o){n["set"+p.replace(/(\w)/,function(q){return q.toUpperCase()})+"Before"](m)}else{if(o>=m.nodeValue.length){n["set"+p.replace(/(\w)/,function(q){return q.toUpperCase()})+"After"](m)}}}}if(!this.collapsed){l(this,"start");l(this,"end")}return this},insertNode:function(n){var p=n,m=1;if(n.nodeType==11){p=n.firstChild;m=n.childNodes.length}this.trimBoundary(true);var q=this.startContainer,o=this.startOffset;var l=q.childNodes[o];if(l){q.insertBefore(n,l)}else{q.appendChild(n)}if(p.parentNode===this.endContainer){this.endOffset=this.endOffset+m}return this.setStartBefore(p)},setCursor:function(l){return this.collapse(l?false:true).select()},createBookmark:function(n,o){var l,m=this.document.createElement("span");m.style.cssText="display:none;line-height:0px;";m.appendChild(this.document.createTextNode("\uFEFF"));m.id="_baidu_bookmark_start_"+(o?"":h++);if(!this.collapsed){l=m.cloneNode(true);l.id="_baidu_bookmark_end_"+(o?"":h++)}this.insertNode(m);if(l){this.collapse(false).insertNode(l);this.setEndBefore(l)}this.setStartAfter(m);return{start:n?m.id:m,end:l?n?l.id:l:null,id:n}},moveToBookmark:function(m){var n=m.id?this.document.getElementById(m.start):m.start,l=m.end&&m.id?this.document.getElementById(m.end):m.end;this.setStartBefore(n);e.remove(n);if(l){this.setEndBefore(l);e.remove(l)}else{this.collapse(true)}return this},enlarge:function(m,p){var l=e.isBody,q,o,n=this.document.createTextNode("");if(m){o=this.startContainer;if(o.nodeType==1){if(o.childNodes[this.startOffset]){q=o=o.childNodes[this.startOffset]}else{o.appendChild(n);q=o=n}}else{q=o}while(1){if(e.isBlockElm(o)){o=q;while((q=o.previousSibling)&&!e.isBlockElm(q)){o=q}this.setStartBefore(o);break}q=o;o=o.parentNode}o=this.endContainer;if(o.nodeType==1){if(q=o.childNodes[this.endOffset]){o.insertBefore(n,q)}else{o.appendChild(n)}q=o=n}else{q=o}while(1){if(e.isBlockElm(o)){o=q;while((q=o.nextSibling)&&!e.isBlockElm(q)){o=q}this.setEndAfter(o);break}q=o;o=o.parentNode}if(n.parentNode===this.endContainer){this.endOffset--}e.remove(n)}if(!this.collapsed){while(this.startOffset==0){if(p&&p(this.startContainer)){break}if(l(this.startContainer)){break}this.setStartBefore(this.startContainer)}while(this.endOffset==(this.endContainer.nodeType==1?this.endContainer.childNodes.length:this.endContainer.nodeValue.length)){if(p&&p(this.endContainer)){break}if(l(this.endContainer)){break}this.setEndAfter(this.endContainer)}}return this},adjustmentBoundary:function(){if(!this.collapsed){while(!e.isBody(this.startContainer)&&this.startOffset==this.startContainer[this.startContainer.nodeType==3?"nodeValue":"childNodes"].length){this.setStartAfter(this.startContainer)}while(!e.isBody(this.endContainer)&&!this.endOffset){this.setEndBefore(this.endContainer)}}return this},applyInlineStyle:function(l,t){if(this.collapsed){return}this.trimBoundary().enlarge(false,function(w){return w.nodeType==1&&e.isBlockElm(w)}).adjustmentBoundary();var r=this.createBookmark(),o=r.end,v=function(w){return w.nodeType==1?w.tagName.toLowerCase()!="br":!e.isWhitespace(w)},q=e.getNextDomNode(r.start,false,v),m,n,p=this.cloneRange();while(q&&(e.getPosition(q,o)&e.POSITION_PRECEDING)){if(q.nodeType==3||a[l][q.tagName]){p.setStartBefore(q);m=q;while(m&&(m.nodeType==3||a[l][m.tagName])&&m!==o){n=m;m=e.getNextDomNode(m,m.nodeType==1,null,function(w){return a[l][w.tagName]})}var u=p.setEndAfter(n).extractContents(),s=p.document.createElement(l);if(t){e.setAttributes(s,t)}s.appendChild(u);e.mergChild(s,l);p.insertNode(s);e.mergSibling(s);e.clearEmptySibling(s);q=e.getNextDomNode(s,false,v);e.mergToParent(s);if(m===o){break}}else{q=e.getNextDomNode(q,true,v)}}return this.moveToBookmark(r)},removeInlineStyle:function(m){if(this.collapsed){return}m=j.isArray(m)?m:[m];this.shrinkBoundary().adjustmentBoundary();var s=this.startContainer,l=this.endContainer;while(1){if(s.nodeType==1){if(j.indexOf(m,s.tagName.toLowerCase())>-1){break}if(s.tagName.toLowerCase()=="body"){s=null;break}}s=s.parentNode}while(1){if(l.nodeType==1){if(j.indexOf(m,l.tagName.toLowerCase())>-1){break}if(l.tagName.toLowerCase()=="body"){l=null;break}}l=l.parentNode}var o=this.createBookmark(),r,q;if(s){q=this.cloneRange().setEndBefore(o.start).setStartBefore(s);r=q.extractContents();q.insertNode(r);e.clearEmptySibling(s,true);s.parentNode.insertBefore(o.start,s)}if(l){q=this.cloneRange().setStartAfter(o.end).setEndAfter(l);r=q.extractContents();q.insertNode(r);e.clearEmptySibling(l,false,true);l.parentNode.insertBefore(o.end,l.nextSibling)}var p=e.getNextDomNode(o.start,false,function(t){return t.nodeType==1}),n;while(p&&p!==o.end){n=e.getNextDomNode(p,true,function(t){return t.nodeType==1});if(j.indexOf(m,p.tagName.toLowerCase())>-1){e.remove(p,true)}p=n}return this.moveToBookmark(o)},getClosedNode:function(){var m;if(!this.collapsed){var l=this.cloneRange().shrinkBoundary();if(l.startContainer.nodeType==1&&l.startContainer===l.endContainer&&l.endOffset-l.startOffset==1){var n=l.startContainer.childNodes[l.startOffset];if(n&&n.nodeType==1&&a.$empty[n.tagName]){m=n}}}return m},select:f.ie?function(l){var q=this.collapsed,t;if(!q){this.shrinkBoundary()}var o=this.getClosedNode();if(o){try{t=this.document.body.createControlRange();t.addElement(o);t.select()}catch(u){}return this}var v=this.createBookmark(),n=v.start,p;t=this.document.body.createTextRange();t.moveToElementText(n);t.moveStart("character",1);if(!q){var s=this.document.body.createTextRange();p=v.end;s.moveToElementText(p);t.setEndPoint("EndToEnd",s)}else{if(!l&&this.startContainer.nodeType!=3){var m=g.fillData,w,r=this.document.createElement("span");try{if(m&&m.parentNode){e.remove(m)}}catch(u){}w=g.fillData=this.document.createTextNode(i);r.appendChild(this.document.createTextNode(e.fillChar));n.parentNode.insertBefore(r,n);n.parentNode.insertBefore(w,n);t.moveStart("character",-1);t.collapse(true)}}this.moveToBookmark(v);t.select();r&&e.remove(r);return this}:function(m){var q=e.getWindow(this.document),p=q.getSelection(),o,r;q.focus();if(p){p.removeAllRanges();if(this.collapsed&&!m&&this.startContainer.nodeType!=3&&!((r=this.startContainer.childNodes[this.startOffset])&&r.nodeType==1&&r.tagName=="BR")){var l=g.fillData;o=g.fillData=this.document.createTextNode(i);this.insertNode(o);if(l&&l.parentNode){e.remove(l)}this.setStart(o,f.webkit?1:0).collapse(true)}var n=this.document.createRange();n.setStart(this.startContainer,this.startOffset);n.setEnd(this.endContainer,this.endOffset);p.addRange(n)}return this}}})();(function(){baidu.editor.dom.Selection=b;var a=baidu.editor.dom.domUtils,e=baidu.editor.dom.dtd,g=baidu.editor.browser.ie;function f(r,j){var k=a.getNodeIndex;r=r.duplicate();r.collapse(j);var v=r.parentElement();if(!v.hasChildNodes()){return{container:v,offset:0}}var u=v.children,l,n=r.duplicate(),w=0,q=u.length-1,s=-1,h;while(w<=q){s=Math.floor((w+q)/2);l=u[s];n.moveToElementText(l);var p=n.compareEndPoints("StartToStart",r);if(p>0){q=s-1}else{if(p<0){w=s+1}else{return e.$empty[l.tagName.toLowerCase()]?{container:v,offset:k(l)}:{container:l,offset:0}}}}if(s==-1){n.moveToElementText(v);n.setEndPoint("StartToStart",r);h=n.text.replace(/(\r\n|\r)/g,"\n").length;u=v.childNodes;if(!h){l=u[u.length-1];return{container:l,offset:l.nodeValue.length}}var o=u.length;while(h>0){h-=u[--o].nodeValue.length}return{container:u[o],offset:-h}}n.collapse(p>0);n.setEndPoint(p>0?"StartToStart":"EndToStart",r);h=n.text.replace(/(\r\n|\r)/g,"\n").length;if(!h){return e.$empty[l.tagName]?{container:v,offset:k(l)+(p>0?0:1)}:{container:l,offset:p>0?0:l.childNodes.length}}while(h>0){try{var m=l;l=l[p>0?"previousSibling":"nextSibling"];h-=l.nodeValue.length}catch(t){return{container:v,offset:k(m)}}}return{container:l,offset:p>0?-h:l.nodeValue.length+h}}function d(j,i){if(j.item){i.selectNode(j.item(0))}else{var h=f(j,true);i.setStart(h.container,h.offset);if(j.compareEndPoints("StartToEnd",j)!=0){h=f(j,false);i.setEnd(h.container,h.offset)}}return i}function c(j){var i=j.getNative().createRange();var h=i.item?i.item(0):i.parentElement();if((h.ownerDocument||h)===j.document){return i}}function b(j){var i=this,h;i.document=j;if(g){h=a.getWindow(j).frameElement;a.on(h,"beforedeactivate",function(){i._bakIERange=i.getIERange()});a.on(h,"activate",function(){try{if(!c(i)&&i._bakIERange){i._bakIERange.select()}}catch(k){}i._bakIERange=null})}win=j=null}b.prototype={getNative:function(){if(g){return this.document.selection}else{return a.getWindow(this.document).getSelection()}},getIERange:function(){var h=c(this);if(!h){if(this._bakIERange){return this._bakIERange}a.getWindow(this.document).focus();return this.getNative().createRange()}return h},cache:function(){this.clear();this._cachedRange=this.getRange();this._cachedStartElement=this.getStart()},clear:function(){this._cachedRange=this._cachedStartElement=null},getRange:function(){if(this._cachedRange!=null){return this._cachedRange}var i=new baidu.editor.dom.Range(this.document);if(g){d(this.getIERange(),i)}else{var j=this.getNative();if(j&&j.rangeCount){var h=j.getRangeAt(0);var k=j.getRangeAt(j.rangeCount-1);i.setStart(h.startContainer,h.startOffset).setEnd(k.endContainer,k.endOffset)}else{i.setStart(this.document.body,0)}}return i},getStart:function(){if(this._cachedStartElement){return this._cachedStartElement}var h=g?this.getIERange():this.getRange(),k,l,i,j;if(g){if(h.item){return h.item(0)}k=h.duplicate();k.text.length>0&&k.moveStart("character",1);k.collapse(1);l=k.parentElement();j=i=h.parentElement();while(i=i.parentNode){if(i==l){l=j;break}}}else{h.shrinkBoundary();l=h.startContainer;if(l.nodeType==1&&l.hasChildNodes()){l=l.childNodes[Math.min(l.childNodes.length-1,h.startOffset)]}if(l.nodeType==3){return l.parentNode}}return l},getText:function(){var h=this.getNative(),i=baidu.editor.browser.ie?h.createRange():h.getRangeAt(0);return i.text||i.toString()}}})();(function(){baidu.editor.Editor=f;var g=baidu.editor,i=g.utils,d=g.EventBase,c=g.dom.domUtils,j=g.dom.Selection,b=g.browser.ie,h=0,e=g.browser,a=g.dom.dtd;function f(k){var l=this;l.uid=h++;d.call(l);l.commands={};l.options=i.extend(k||{},f.DEFAULT_OPTIONS,true);l.initPlugins()}f.DEFAULT_OPTIONS={initialStyle:"",initialContent:"",iframeCssUrl:"",removeFormatTags:"a,b,big,code,del,dfn,em,font,i,ins,kbd,q,samp,small,span,strike,strong,sub,sup,tt,u,var",removeFormatAttributes:"class,style,lang,width,height,align,hspace,valign",enterTag:"p",maxUndoCount:20,maxInputCount:20,minFrameHeight:400,selectedTdClass:"selectTdClass",pasteplain:0};f.prototype={render:function(k){if(k.constructor===String){k=document.getElementById(k)}var n="baidu_editor_"+this.uid;k.innerHTML='<iframe id="'+n+'"width="100%" height="100%" scroll="no" frameborder="0"></iframe>';if(k.style.position!="absolute"){k.style.position="relative"}var l=document.getElementById(n),m=l.contentWindow.document;this.setup(m)},setup:function(m){var k=this.options;m.open();var l=(b?"":"<!DOCTYPE html>")+'<html xmlns="http://www.w3.org/1999/xhtml"><head><title></title><style type="text/css">'+(b?"body":"html")+"{ cursor: text; height: 100%; }"+(k.initialStyle)+"</style>"+(k.iframeCssUrl?'<link rel="stylesheet" type="text/css" href="'+i.unhtml(k.iframeCssUrl)+'"/>':"")+"</head><body></body></html>";m.write(l);m.close();if(b){m.body.disabled=true;m.body.contentEditable=true;m.body.removeAttribute("disabled")}else{m.designMode="on";m.body.spellcheck=false}this.document=m;this.window=m.defaultView||m.parentWindow;this.iframe=this.window.frameElement;if(this.options.minFrameHeight){this.iframe.style.height=this.options.minFrameHeight+"px"}this.body=m.body;this.selection=new j(m);this._initEvents();this.options.initialContent&&this.setContent(this.options.initialContent);this.fireEvent("ready")},getContent:function(){this.fireEvent("beforegetcontent");var l=new RegExp(c.fillChar,"g"),k=this.document.body.innerHTML.replace(l,"");this.fireEvent("aftergetcontent");return k},getContentTxt:function(){var k=new RegExp(c.fillChar,"g");return this.document.body[e.ie?"innerText":"textContent"].replace(k,"")},setContent:function(k){var l=this;l.fireEvent("beforesetcontent");this.document.body.innerHTML=k;var n=this.body.firstChild;while(n){if(n.nodeType==3&&!c.isWhitespace(n)){var m=this.document.createElement("p");this.body.insertBefore(m,n);m.appendChild(n);n=m}n=n.nextSibling}l.fireEvent("aftersetcontent")},focus:function(){c.getWindow(this.document).focus()},initPlugins:function(l){var n,k=baidu.editor.plugins;if(l){for(var m=0,o;o=l[m++];){if(i.indexOf(this.options.plugins,o)==-1&&(n=baidu.editor.plugins[o])){this.options.plugins.push(o);n.call(this)}}}else{l=this.options.plugins;if(l){for(m=0;o=k[l[m++]];){o.call(this)}}else{this.options.plugins=[];for(o in k){this.options.plugins.push(o);k[o].call(this)}}}},_initEvents:function(){var m=this,q=this.document,p=c.getWindow(q);var l=i.defer(i.bind(m._selectionChange,m),100,true);m._proxyDomEvent=i.bind(m._proxyDomEvent,m);c.on(q,["click","contextmenu","mousedown","mouseup","keydown","keyup","keypress","mouseover","mouseout","selectstart"],m._proxyDomEvent);c.on(p,["focus","blur"],m._proxyDomEvent);c.on(q,["mouseup","keyup"],l);var k=0,n=e.ie?m.body:m.document,o;c.on(n,"dragstart",function(){k=1});c.on(n,e.webkit?"dragover":"drop",function(){return e.webkit?function(){clearTimeout(o);o=setTimeout(function(){if(!k){var t=m.selection,r=t.getRange();if(r){var s=r.getCommonAncestor();s&&m.filter&&m.filter.doFilter(s)}}k=0},200)}:function(r){if(!k){r.preventDefault?r.preventDefault():(r.returnValue=false)}k=0}}())},_proxyDomEvent:function(k){return this.fireEvent(k.type.replace(/^on/,""),k)},_selectionChange:function(){var q=this;try{var k=g.fillData,p=new RegExp(c.fillChar,"g"),o=k.parentNode;if(k&&o){if(k.nodeValue.replace(p,"").length){k.nodeValue=k.nodeValue.replace(p,"");g.fillData=null}else{var l=this.selection.getRange(),m,n;m=l.startContainer.nodeType==3?l.startContainer:l.startContainer.childNodes[l.startOffset];if(!(m&&m.nodeType==3&&m.nodeValue.replace(p,"").length==0)){if(e.webkit){n=l.createBookmark()}c.remove(k);g.fillData=null;n&&l.moveToBookmark(n).select();while(a.$removeEmpty[o.tagName]&&o.childNodes.length==0){m=o;c.remove(o);o=m.parentNode}}}}}catch(r){}q.selection.cache();if(q.selection._cachedRange&&q.selection._cachedStartElement){q.fireEvent("beforeselectionchange");q.fireEvent("selectionchange");q.selection.clear()}},_callCmdFn:function(o,l){var k=l[0].toLowerCase(),n,m;m=(n=this.commands[k])&&n[o]||(n=baidu.editor.commands[k])&&n[o];if(n&&!m&&o=="queryCommandState"){return false}else{if(m){return m.apply(this,l)}}},execCommand:function(l){l=l.toLowerCase();var m=this,k,n=m.commands[l]||baidu.editor.commands[l];if(!n||!n.execCommand){return}if(!n.notNeedUndo&&!m.__hasEnterExecCommand){m.__hasEnterExecCommand=true;m.fireEvent("beforeexeccommand",l);k=this._callCmdFn("execCommand",arguments);m.fireEvent("afterexeccommand",l);m.__hasEnterExecCommand=false}else{k=this._callCmdFn("execCommand",arguments)}m._selectionChange();return k},queryCommandState:function(k){return this._callCmdFn("queryCommandState",arguments)},queryCommandValue:function(k){return this._callCmdFn("queryCommandValue",arguments)},hasContents:function(){var k=this.body[e.ie?"innerText":"textContent"],l=new RegExp("[ \t\n\r"+c.fillChar+"]","g");return !!k.replace(l,"").length}};i.inherits(f,d)})();(function(){var f={bold:["strong","b"],italic:["em","i"],underline:["u"],strikethrough:["strike"],subscript:["sub"],superscript:["sup"]},b=baidu.editor.dom.domUtils,e=function(h,g){var i=h.selection.getStart();return b.findParentByTagName(i,g,true)},a=function(){var p=["strong","em","span","u"],h,j=new RegExp(b.fillChar,"g"),m=this.document,k;for(var n=0,g;g=p[n++];){h=m.getElementsByTagName(g);for(var l=0,o;o=h[l++];){if(o.parentNode&&o[baidu.editor.browser.ie?"innerText":"textContent"].replace(j,"").length==0&&o.children.length==0){k=o.parentNode;b.remove(o);while(k.childNodes.length==0&&new RegExp(p.join("|"),"i").test(k.tagName)){o=k;k=k.parentNode;b.remove(o)}}}}},c=0;for(var d in f){(function(h,g){baidu.editor.commands[h]={execCommand:function(k){var j=new baidu.editor.dom.Range(this.document),p="";if(this.currentSelectedArr&&this.currentSelectedArr.length>0){for(var m=0,l;l=this.currentSelectedArr[m++];){if(l.style.display!="none"){j.selectNodeContents(l).select();p===""&&(p=e(this,g)?1:0);p?j.removeInlineStyle(g):j.applyInlineStyle(g[0])}}j.selectNodeContents(this.currentSelectedArr[0]).select()}else{j=this.selection.getRange();p=e(this,g);if(j.collapsed){if(p){var o=this.document.createTextNode("");j.insertNode(o).removeInlineStyle(g);j.setStartBefore(o);b.remove(o)}else{var n=j.document.createElement(g[0]);j.insertNode(n).setStart(n,0);if(!c){this.addListener("beforegetcontent",a);c=1}}j.collapse(true)}else{p?j.removeInlineStyle(g):j.applyInlineStyle(g[0])}j.select()}return true},queryCommandState:function(){return e(this,g)?1:0}}})(d,f[d])}})();(function(){var a=baidu.editor.dom.domUtils,c=baidu.editor.browser,b=c.webkit,d=c.gecko;baidu.editor.commands.insertorderedlist=baidu.editor.commands.insertunorderedlist={execCommand:function(j,x){var y=this,o=y.queryCommandState(j),z=this.document,s;if(c.ie){var m=y.selection.getStart(),h=a.findParent(m,function(i){return i.tagName=="BLOCKQUOTE"}),l=0;if(h){l=1}}x=x&&x.toLowerCase()||(j=="insertorderedlist"?"decimal":"disc");if(o&&a.getStyle(o,"list-style-type")==x){s=y.selection.getRange();if(!s.collapsed){s.shrinkBoundary();var m=s.startContainer,k=s.endContainer,p=a.findParentByTagName(m,"li",true),u=a.findParentByTagName(k,"li",true);if(p&&u&&!p.previousSibling&&!u.nextSibling){var n=s.createBookmark(),r=p.parentNode,g=z.createDocumentFragment(),f=r.getElementsByTagName("li");for(var w=0,q;q=f[w++];){var e=z.createElement("p");while(q.firstChild){e.appendChild(q.firstChild)}g.appendChild(e)}r.parentNode.insertBefore(g,r);a.remove(r);s.moveToBookmark(n);return true}}}if(!o||a.getStyle(o,"list-style-type")==x){z.execCommand(j,false,null)}o=y.queryCommandState(j);if(o){if(d){o.removeAttribute("_moz_dirty");var t=o.getElementsByTagName("*");for(var w=0,q;q=t[w++];){q.removeAttribute("_moz_dirty")}}if(b){var f=o.getElementsByTagName("li");if(o.parentNode.tagName.toLowerCase()=="p"){s=this.selection.getRange();var n=s.createBookmark();a.remove(o.parentNode,true);s.moveToBookmark(n).select()}}o.style.listStyleType=x;if(c.ie&&l&&!a.findParent(o,function(i){return i.tagName=="BLOCKQUOTE"})){var v=a.findParent(o,function(i){return i.tagName==j.toLowerCase()=="insertorderedlist"?"OL":"UL"});if(v){h.innerHTML="";while(v.firstChild){h.appendChild(v.firstChild)}v.parentNode.insertBefore(h,v);a.remove(v)}}}},queryCommandState:function(f){var e=this.selection.getStart();return a.findParentByTagName(e,f.toLowerCase()=="insertorderedlist"?"ol":"ul",true)},queryCommandValue:function(f){var e=this.queryCommandState(f);return e?a.getStyle(e,"list-style-type"):null}}})();(function(){var a=baidu.editor.dom.domUtils,d=a.isBlockElm,c=function(j){var f=j.selection.getStart(),e;if(f){e=a.findParents(f,true,d,true);for(var h=0,g;g=e[h++];){if(g.getAttribute("dir")){return g}}}},b=function(i,j,h){var m,q=function(p){return p.nodeType==1?!a.isBookmarkNode(p):!a.isWhitespace(p)},g=c(j);if(g&&i.collapsed){g.setAttribute("dir",h);return i}m=i.createBookmark();i.enlarge(true);var r=i.createBookmark(),l=a.getNextDomNode(r.start,false,q),n=i.cloneRange(),f;while(l&&!(a.getPosition(l,r.end)&a.POSITION_FOLLOWING)){if(l.nodeType==3||!d(l)){n.setStartBefore(l);while(l&&l!==r.end&&!d(l)){f=l;l=a.getNextDomNode(l,false,null,function(p){return !d(p)})}n.setEndAfter(f);var k=n.getCommonAncestor();if(!a.isBody(k)&&d(k)){k.setAttribute("dir",h);l=k}else{var e=i.document.createElement("p");e.setAttribute("dir",h);var o=n.extractContents();e.appendChild(o);n.insertNode(e);l=e}l=a.getNextDomNode(l,false,q)}else{l=a.getNextDomNode(l,true,q)}}return i.moveToBookmark(r).moveToBookmark(m)};baidu.editor.commands.directionality={execCommand:function(g,f){var e=new baidu.editor.dom.Range(this.document);if(this.currentSelectedArr&&this.currentSelectedArr.length>0){for(var h=0,j;j=this.currentSelectedArr[h++];){if(j.style.display!="none"){b(e.selectNode(j),this,f)}}e.selectNode(this.currentSelectedArr[0]).select()}else{b(e=this.selection.getRange(),this,f).select()}return true},queryCommandValue:function(){var e=c(this);return e?e.getAttribute("dir"):"ltr"}}})();(function(){var a=baidu.editor.dom.domUtils,c=baidu.editor.dom.dtd,b=baidu.editor.utils;baidu.editor.commands.inserthtml={execCommand:function(h,n){var p=this,o,r,l,t,e,k=p.currentSelectedArr;o=p.selection.getRange();e=o.document.createElement("div");e.style.display="inline";e.innerHTML=b.trim(n);if(!o.collapsed){o.deleteContents();if(o.startContainer.nodeType==1){var f=o.startContainer.childNodes[o.startOffset],g;if(f&&a.isBlockElm(f)&&(g=f.previousSibling)&&a.isBlockElm(g)){o.setEnd(g,g.childNodes.length).collapse();while(f.firstChild){g.appendChild(f.firstChild)}a.remove(f)}}}if(k&&k.length){for(var l=0,d;d=k[l++];){d.className=""}k[0].innerHTML="";o.setStart(k[0],0).collapse(true);p.currentSelectedArr=[]}var f,s,g,j,q=0;while(f=e.firstChild){o.insertNode(f);if(!q&&f.nodeType==a.NODE_ELEMENT&&a.isBlockElm(f)){s=a.findParent(f,function(i){return a.isBlockElm(i)});if(s&&s.tagName.toLowerCase!="body"&&!(c[s.tagName][f.nodeName]&&f.parentNode===s)){if(!c[s.tagName][f.nodeName]){g=s}else{j=f.parentNode;while(j!==s){g=j;j=j.parentNode}}a.breakParent(f,g||j);var g=f.previousSibling;a.trimWhiteTextNode(g);if(!g.childNodes.length){a.remove(g)}q=1}}var m=f.nextSibling;if(!e.firstChild&&m&&a.isBlockElm(m)){o.setStart(m,0).collapse(true);break}o.setEndAfter(f).collapse()}o.select()}}}());(function(){var a=new RegExp(baidu.editor.dom.domUtils.fillChar+"|</hr>","gi");baidu.editor.plugins.undo=function(){var g=this,i=g.options.maxUndoCount,f=g.options.maxInputCount,b=/\b(?:href|src|name)="[^"]*?"/gi;function d(){this.list=[];this.index=0;this.hasUndo=false;this.hasRedo=false;this.undo=function(){if(this.hasUndo){var l=this.getScene(),k=this.list[this.index];if(k.content.replace(b,"")!=l.content.replace(b,"")){this.save()}while(this.list[this.index].content==this.list[this.index-1].content){this.index--;if(this.index==0){return this.restore(0)}}this.restore(--this.index)}};this.redo=function(){if(this.hasRedo){while(this.list[this.index].content==this.list[this.index+1].content){this.index++;if(this.index==this.list.length-1){return this.restore(this.index)}}this.restore(++this.index)}};this.restore=function(){var n=this.list[this.index];g.document.body.innerHTML=n.bookcontent;var k=new baidu.editor.dom.Range(g.document);k.moveToBookmark({start:"_baidu_bookmark_start_",end:"_baidu_bookmark_end_",id:true}).select(true);this.update();if(g.currentSelectedArr){g.currentSelectedArr=[];var m=g.document.getElementsByTagName("td");for(var l=0,o;o=m[l++];){if(o.className==g.options.selectedTdClass){g.currentSelectedArr.push(o)}}}};this.getScene=function(){var l=g.selection.getRange(),k=g.body.innerHTML.replace(a,"");baidu.editor.browser.ie&&(k=k.replace(/>&nbsp;</g,"><").replace(/\s*</g,"").replace(/>\s*/g,">"));var n=l.createBookmark(true,true),m=g.body.innerHTML.replace(a,"");l.moveToBookmark(n).select(true);return{bookcontent:m,content:k}};this.save=function(){var l=this.getScene(),k=this.list[this.index];if(k&&k.content==l.content&&k.bookcontent==l.bookcontent){return}this.list=this.list.slice(0,this.index+1);this.list.push(l);if(this.list.length>i){this.list.shift()}this.index=this.list.length-1;e=0;c=null;this.update()};this.update=function(){this.hasRedo=this.list[this.index+1]?true:false;this.hasUndo=this.list[this.index-1]||this.list.length==1?true:false};this.reset=function(){this.list=[];this.index=0;this.hasUndo=false;this.hasRedo=false}}g.undoManger=new d();function h(){this.undoManger.save()}g.addListener("beforeexeccommand",h);g.addListener("afterexeccommand",h);g.commands.redo=g.commands.undo={execCommand:function(k){g.undoManger[k]()},queryCommandState:function(k){return g.undoManger["has"+(k.toLowerCase()=="undo"?"Undo":"Redo")]?0:-1},notNeedUndo:1};var j={16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},e=0,c;g.addListener("keydown",function(l,k){var m=k.keyCode||k.which;if(!j[m]&&!k.ctrlKey&&!k.metaKey&&!k.shiftKey&&!k.altKey){if(e==0||((m==8||m==46)&&c!=m)){g.undoManger.save()}c=m;e++;if(e>f){setTimeout(function(){g.undoManger.save()},0)}}})}})();(function(){var a=baidu.editor.dom.domUtils,b=baidu.editor.browser;function c(h){var f=this.document;if(f.getElementById("baidu_pastebin")){return}var e=this.selection.getRange(),d=e.createBookmark(),g=f.createElement("div");g.id="baidu_pastebin";b.webkit&&g.appendChild(f.createTextNode("\xa0"));f.body.appendChild(g);g.style.cssText="position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;top:"+a.getXY(d.start).y+"px";e.selectNodeContents(g).select(true);setTimeout(function(){g.parentNode.removeChild(g);e.moveToBookmark(d).select(true);h(g)},0)}baidu.editor.plugins.paste=function(){var e=this;var d=e.options.pasteplain;e.commands.pasteplain={queryCommandState:function(){return d},execCommand:function(){d=!d|0},notNeedUndo:1};e.addListener("keydown",function(g,i){var h=i.keyCode||i.which,f;if((i.ctrlKey||i.metaKey)&&h==86){c.call(e,function(j){if(j.firstChild){if(b.webkit){var p=j.querySelectorAll("span.Apple-style-span");for(var n=0,s;s=p[n++];){a.remove(s,true)}var q=j.querySelectorAll("meta");for(var n=0,s;s=q[n++];){a.remove(s)}}if(b.gecko){var r=j.querySelectorAll("[_moz_dirty]");for(n=0;s=r[n++];){s.removeAttribute("_moz_dirty")}}if(!d){f=j.innerHTML;var o=e.serialize;if(o){var m=o.filter(o.parseHTML(o.word(f)));if(b.webkit){var l=m.children.length,k;while((k=m.children[l-1])&&k.tag=="br"){m.children.splice(l-1,1);l=m.children.length}}f=o.toHTML(m)}}else{f=j[b.ie?"innerText":"textContent"]}e.execCommand("insertHtml",f)}})}})}})();(function(){var a=baidu.editor.browser;baidu.editor.plugins.autoheight=function(){var c=this;c.autoHeightEnabled=false;var e;var d;var b;c.enableAutoHeight=function(){var f=c.iframe,h=c.document,g=c.options.minFrameHeight;function i(){f.style.height=Math.max(a.ie?h.body.scrollHeight:h.body.offsetHeight+20,g)+"px"}this.autoHeightEnabled=true;d=f.scroll;b=h.body.style.overflowY;f.scroll="no";h.body.style.overflowY="hidden";e=setTimeout(function(){i();e=setTimeout(arguments.callee)})};c.disableAutoHeight=function(){var f=c.iframe,g=c.document;f.scroll=d;g.body.style.overflowY=b;clearTimeout(e);this.autoHeightEnabled=false};c.addListener("ready",function(){c.enableAutoHeight()})}})();baidu.editor.plugins.shortcutkeys=function(){var a=this,b=baidu.editor.utils.extend({"ctrl+66":"Bold","ctrl+90":"Undo","ctrl+89":"Redo","ctrl+73":"Italic","ctrl+85":"Underline","ctrl+shift+67":"removeformat","ctrl+shift+76":"justify:left","ctrl+shift+82":"justify:right","ctrl+65":"selectAll"},a.options.shortcutkeys);a.addListener("keydown",function(d,h){var g=h.keyCode||h.which,f;for(var c in b){if(/^(ctrl)(\+shift)?\+(\d+)$/.test(c.toLowerCase())||/^(\d+)$/.test(c)){if(((RegExp.$1=="ctrl"?(h.ctrlKey||h.metaKey):0)&&(RegExp.$2!=""?h[RegExp.$2.slice(1)+"Key"]:1)&&g==RegExp.$3)||g==RegExp.$1){f=b[c].split(":");a.execCommand(f[0],f[1]);h.preventDefault?h.preventDefault():(h.returnValue=false)}}}})};(function(){var b=baidu.editor.browser,a=baidu.editor.dom.domUtils;baidu.editor.plugins.enterkey=function(){var e=this,c=e.options.enterTag,d=0;e.addListener("keyup",function(g,f){var h=f.keyCode||f.which;if(h==13&&e.undoManger&&d){d=0;e.undoManger.save()}});e.addListener("keypress",function(k,m){var o=m.keyCode||m.which;if(o==13){if(e.undoManger){e.undoManger.save();d=1}var h=e.selection.getRange();h.shrinkBoundary();if(a.findParentByTagName(h.startContainer,["ol","ul"],true)){return}if(!h.collapsed){var f=h.startContainer,g=h.endContainer,i=a.findParentByTagName(f,"td",true),j=a.findParentByTagName(g,"td",true);if(i&&j&&i!==j||!i&&j||i&&!j){m.preventDefault?m.preventDefault():(m.returnValue=false);return}}if(c=="p"){if(!b.ie){f=a.findParentByTagName(h.startContainer,["p","h1","h2","h3","h4","h5","h6"],true);if(!f){e.document.execCommand("formatBlock",false,"<p>");if(b.gecko){h=e.selection.getRange();f=a.findParentByTagName(h.startContainer,"p",true);f&&a.removeDirtyAttr(f)}}else{f.tagName.toLowerCase()=="p"&&b.gecko&&a.removeDirtyAttr(f)}}}else{m.preventDefault?m.preventDefault():(m.returnValue=false);if(!h.collapsed){h.deleteContents();f=h.startContainer;if(f.nodeType==1&&(f=f.childNodes[h.startOffset])){while(f.nodeType==1){if(baidu.editor.dom.dtd.$empty[f.tagName]){h.setStartBefore(f).setCursor();if(e.undoManger){e.undoManger.save()}return false}if(!f.firstChild){var n=h.document.createElement("br");f.appendChild(n);h.setStart(f,0).setCursor();if(e.undoManger){e.undoManger.save()}return false}f=f.firstChild}if(f===h.startContainer.childNodes[h.startOffset]){n=h.document.createElement("br");h.insertNode(n).setCursor()}else{h.setStart(f,0).setCursor()}}else{n=h.document.createElement("br");h.insertNode(n).setStartAfter(n).setCursor()}}else{n=h.document.createElement("br");h.insertNode(n);var l=n.parentNode;if(l.lastChild===n){n.parentNode.insertBefore(n.cloneNode(true),n);h.setStartBefore(n)}else{h.setStartAfter(n)}h.setCursor()}}if(e.undoManger){e.undoManger.save()}}})}})();(function(){var a=baidu.editor.dom.domUtils,c=baidu.editor.browser,d=baidu.editor.dom.dtd,b=0;baidu.editor.plugins.keystrokes=function(){var e=this;e.addListener("keydown",function(i,g){var l=g.keyCode||g.which;if(l==8||l==46){var h=e.selection.getRange();if(c.ie&&h.collapsed&&!h.startOffset){var f=a.findParentByTagName(h.startContainer,"li",true),k,j=h.cloneRange();j.trimBoundary();if(!j.startOffset){if(f&&(k=f.previousSibling)){if(l==46&&f.childNodes.length){return}e.undoManger&&e.undoManger.save();h.setEnd(k,k.childNodes.length).collapse();while(f.firstChild){k.appendChild(f.firstChild)}a.remove(f);h.select();e.undoManger&&e.undoManger.save();g.returnValue=false}var j=h.cloneRange();j.trimBoundary();if(l==8&&(f&&k||f&&f.childNodes.length)){g.returnValue=false}}}if(e.undoManger){if(!h.collapsed){e.undoManger.save();b=1}}}});e.addListener("keyup",function(m,p){var r=p.keyCode||p.which;if(r==8||r==46){var k,l,g,o,j=this.currentSelectedArr;if(j&&j.length>0){for(var h=0,f;f=j[h++];){f.innerHTML=c.ie?(c.version<9?"&#65279":""):"<br/>"}k=new baidu.editor.dom.Range(this.document);k.setStart(j[0],0).setCursor();if(b){e.undoManger.save();b=0}if(c.webkit){p.preventDefault()}return}k=e.selection.getRange();if(a.isBody(k.startContainer)&&!k.startOffset){l=e.document.body;if(l.childNodes.length==1&&l.firstChild.nodeType==1&&l.firstChild.tagName.toLowerCase()=="br"&&e.options.enterTag=="p"||e.body.innerHTML==""){e.document.execCommand("formatBlock",false,"<p>");if(c.gecko){k=e.selection.getRange();g=a.findParentByTagName(k.startContainer,"p",true);g&&a.removeDirtyAttr(g)}e.undoManger.save();return}}g=k.startContainer;while(g.nodeType==1&&d.$removeEmpty[g.tagName]){if(a.getChildCount(g,function(i){return i.nodeType!=1||i.tagName.toLowerCase()!="br"})>0){break}o=g.parentNode;a.remove(g);g=o}if(g.nodeType==1&&g.childNodes.length==0){if(c.ie){var n=k.document.createElement("span");g.appendChild(n);k.setStart(n,0).setCursor()}else{var q=k.document.createElement("br");g.appendChild(q);k.setStart(g,0).setCursor()}setTimeout(function(){if(c.ie){a.remove(n)}if(b){e.undoManger.save();b=0}},0)}else{if(b){e.undoManger.save();b=0}}}})}})();(function(){var a=baidu.editor.dom.dtd;var c=a.$empty;var j=baidu.editor.utils.unhtml;var k=function(){var o=/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)-->)|(?:([^\s/>]+)\s*((?:(?:"[^"]*")|(?:'[^']*')|[^"'<>])*)\/?>))/g;var m=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g;var p={checked:1,compact:1,declare:1,defer:1,disabled:1,ismap:1,multiple:1,nohref:1,noresize:1,noshade:1,nowrap:1,readonly:1,selected:1};var s={script:1,style:1};var n={li:{"$":"ul",ul:1,ol:1},dd:{"$":"dl",dl:1},dt:{"$":"dl",dl:1},option:{"$":"select",select:1},td:{"$":"tr",tr:1},tr:{"$":"tbody",tbody:1,thead:1,tfoot:1,table:1},tbody:{"$":"table",table:1},thead:{"$":"table",table:1},tfoot:{"$":"table",table:1},col:{"$":"colgroup"}};var q={table:"td",tbody:"td",thead:"td",tfoot:"td",tr:"td",colgroup:"col",ul:"li",ol:"li",dl:"dd",select:"option"};function r(w,A){var x,y=0,u,F;o.exec("");while((x=o.exec(w))){var D=x.index;if(D>y){var G=w.slice(y,D);if(F){F.push(G)}else{A.onText(G)}}y=o.lastIndex;if((u=x[1])){u=u.toLowerCase();if(F&&u==F._tag_name){A.onCDATA(F.join(""));F=null}if(!F){A.onTagClose(u);continue}}if(F){F.push(x[0]);continue}if((u=x[3])){if(/="/.test(u)){continue}u=u.toLowerCase();var E=x[4],t,v={},C=E&&E.slice(-1)=="/";if(E){m.exec("");while((t=m.exec(E))){var B=t[1].toLowerCase(),z=t[2]||t[3]||t[4]||"";if(!z&&p[B]){z=B}v[B]=z}}A.onTagOpen(u,v,C);if(!F&&s[u]){F=[];F._tag_name=u}continue}if((u=x[2])){A.onComment(u)}}if(w.length>y){A.onText(w.slice(y,w.length))}}return function(w){var u={type:"fragment",parent:null,children:[]};var v=u;function y(z){z.parent=v;v.children.push(z)}function x(A,z){var B=A;if(n[B.tag]){while(n[v.tag]&&n[v.tag][B.tag]){v=v.parent}if(v.tag==B.tag){v=v.parent}while(n[B.tag]){if(n[B.tag][v.tag]){break}B=B.parent={type:"element",tag:n[B.tag]["$"],attributes:{},children:[B]}}}while(!(a[v.tag]||a.div)[B.tag]){if(t(v)){continue}if(!v.parent){break}v=v.parent}B.parent=v;v.children.push(B);if(z){v=A}return A}function t(z){var A;if(!z.children.length&&(A=q[z.tag])){x({type:"element",tag:A,attributes:{},children:[]},true);return true}return false}r(w,{onText:function(z){while(!a[v.tag||"div"]["#"]){if(t(v)){continue}v=v.parent}if(/\S/.test(z)){y({type:"text",data:z})}},onComment:function(z){y({type:"comment",data:z})},onCDATA:function(z){while(!a[v.tag||"div"]["#"]){if(t(v)){continue}v=v.parent}y({type:"cdata",data:z})},onTagOpen:function(z,B,A){A=A||c[z];x({type:"element",tag:z,attributes:B,closed:A,children:[]},!A)},onTagClose:function(z){var A=v;while(A&&z!=A.tag){A=A.parent}if(A){for(var B=v;B!==A.parent;B=B.parent){t(B)}v=A.parent}else{A={type:"element",tag:z,attributes:{},children:[]};x(A,true);t(A);v=A.parent}}});while(v!==u){t(v);v=v.parent}return u}}();var h={b:1,i:1,font:1};function i(o){var n=[0,10,12,16,18,24,32,48],m;switch(o.tag){case"b":o.tag=o.name="strong";break;case"i":o.tag=o.name="em";break;case"font":o.tag=o.name="span";m=o.attributes;o.attributes={style:(m.size?"font-size:"+(n[m.size]||12)+"px":"")+";"+(m.color?"color:"+m.color:"")+";"+(m.face?"font-family:"+m.face:"")+";"+(m.style||"")}}}var d=function(){var n={"<":"&lt;",">":"&gt;"};function m(o){return n[o]}return function(o){return o?o.replace(/[<>]/g,m):""}}();var e=function(){function n(s){var r=s.children;var t=[];for(var q=0;q<r.length;q++){t.push(e(r[q]))}return t.join("")}function o(r){var s=[];for(var q in r){s.push(q+'="'+j(r[q])+'"')}return s.join(" ")}function m(q){return d(q.data)}function p(t){if(h[t.tag]){i(t)}var q=t.tag;var r=o(t.attributes);var s="<"+q+(r?" "+r:"")+(c[q]?" />":">");if(!c[q]){s+=n(t);s+="</"+q+">"}return s}return function(q){if(q.type=="fragment"){return n(q)}else{if(q.type=="element"){return p(q)}else{if(q.type=="text"||q.type=="cdata"){return m(q)}else{if(q.type=="comment"){return"<!--"+q.data+"-->"}}}}return""}}();var g=function(){function n(q){var p=new RegExp(/(class="?Mso|style="[^"]*\bmso\-|w:WordDocument)/ig);return p.test(q)}function o(p){p=p.replace(/([\d.]+)([\w]+)?/g,function(q,s,r){return(Math.round(parseFloat(s))||1)+(r||"px")});return p}function m(p){p=p.replace(/\r\n|\n|\r/ig,"");p=p.replace(/^\s*(&nbsp;)+/ig,"");p=p.replace(/(&nbsp;|<br[^>]*>)+\s*$/ig,"");p=p.replace(/<!--[\s\S]*?-->/ig,"");p=p.replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|xml|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,"");p=p.replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>");p=p.replace(/(lang)\s*=\s*([\'\"]?)[\w-]+\2/ig,"");p=p.replace(/(<[a-z][^>]*)\sstyle="([^"]*)"/gi,function(x,B,q){var t=[],w=0,A=q.replace(/^\s+|\s+$/,"").replace(/&quot;/gi,"'").split(/;\s*/g);for(var w=0;w<A.length;w++){var z=A[w];var r,y,u=z.split(":");if(u.length==2){r=u[0].toLowerCase();y=u[1].toLowerCase();switch(r){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-table-layout-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":t[w++]=r.replace(/^mso-|-alt$/g,"")+":"+o(y);continue;case"horiz-align":t[w++]="text-align:"+y;continue;case"vert-align":t[w++]="vertical-align:"+y;continue;case"font-color":case"mso-foreground":t[w++]="color:"+y;continue;case"mso-background":case"mso-highlight":t[w++]="background:"+y;continue;case"mso-default-height":t[w++]="min-height:"+o(y);continue;case"mso-default-width":t[w++]="min-width:"+o(y);continue;case"mso-padding-between-alt":t[w++]="border-collapse:separate;border-spacing:"+o(y);continue;case"text-line-through":if((y=="single")||(y=="double")){t[w++]="text-decoration:line-through"}continue;case"mso-zero-height":if(y=="yes"){t[w++]="display:none"}continue}if(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:align|decor|indent|trans)|top-bar|version|vnd|word-break)/.test(r)){continue}t[w]=r+":"+u[1]}}if(w>0){return B+' style="'+t.join(";")+'"'}else{return B}});p=p.replace(/([ ]+)<\/span>/ig,function(q,r){return new Array(r.length+1).join("&nbsp;")+"</span>"});return p}return function(p){if(n(p)){p=m(p)}return p.replace(/>\s*</g,"><")}}();var l={text:"#text",comment:"#comment",cdata:"#cdata-section",fragment:"#document-fragment"};function f(s,r,m){if(!s.children){return s}var q=s.children;for(var p=0;p<q.length;p++){var o=r(q[p],m);if(o.type=="fragment"){var n=[p,1];n.push.apply(n,o.children);q.splice.apply(q,n);p--}else{q[p]=o}}return s}function b(m){this.rules=m}b.prototype={rules:null,filter:function(o){var n=this.rules&&this.rules.whiteList;var m=this.rules&&this.rules.blackList;function p(u,t){u.name=u.type=="element"?u.tag:l[u.type];if(t==null){return f(u,p,u)}if(m&&m[u.name]){return{type:"fragment",children:[]}}if(n){if(u.type=="element"){if(t.type=="fragment"?n[u.name]:n[u.name]&&n[t.name][u.name]){var s;if((s=n[u.name].$)){var v=u.attributes;var r={};for(var q in s){if(v[q]){r[q]=v[q]}}u.attributes=r}}else{u.type="fragment";u.name=t.name}}else{}}if(m||n){f(u,p,u)}return u}return p(o,null)},transformInput:function(m,n){return m},transformOutput:function(m){return m},toHTML:e,parseHTML:k,word:g};baidu.editor.plugins.serialize=function(){var m=this;m.serialize=new b(m.options.serialize)}})();var baidu=baidu||{};baidu.editor=baidu.editor||{};baidu.editor.ui={};(function(){var d=baidu.editor.browser,c=baidu.editor.dom.domUtils;var g="$EDITORUI";var f=window[g]={};var a="ID"+g;var i=0;var b=baidu.editor.ui.uiUtils={uid:function(j){return(j?j[a]||(j[a]=++i):++i)},hook:function(j,l){var k;if(j&&j._callbacks){k=j}else{k=function(){var p;if(j){p=j.apply(this,arguments)}var o=k._callbacks;var m=o.length;while(m--){var n=o[m].apply(this,arguments);if(p===undefined){p=n}}return p};k._callbacks=[]}k._callbacks.push(l);return k},createElementByHtml:function(j){var k=document.createElement("div");k.innerHTML=j;k=k.firstChild;k.parentNode.removeChild(k);return k},getViewportElement:function(){return(d.ie&&d.quirks)?document.body:document.documentElement},getClientRect:function(j){var l=j.getBoundingClientRect();var k={left:l.left|0,top:l.top|0,height:(l.bottom-l.top)|0,width:(l.right-l.left)|0};while(j=c.getWindow(j).frameElement){l=j.getBoundingClientRect();k.left+=l.left;k.top+=l.top}k.bottom=k.top+k.height;k.right=k.left+k.width;return k},getViewportRect:function(){var k=b.getViewportElement();var l=k.clientWidth|0;var j=k.clientHeight|0;return{left:0,top:0,height:j,width:l,bottom:j,right:l}},setViewportOffset:function(j,n){var m=parseInt(j.style.left)|0;var l=parseInt(j.style.top)|0;var k=b.getClientRect(j);m=m+n.left-k.left;l=l+n.top-k.top;j.style.left=m+"px";j.style.top=l+"px"},getEventOffset:function(j){var k=j.target||j.srcElement;var l=b.getClientRect(k);var m=b.getViewportOffsetByEvent(j);return{left:m.left-l.left,top:m.top-l.top}},getViewportOffsetByEvent:function(k){var l=k.target||k.srcElement;var j=c.getWindow(l).frameElement;var n={left:k.clientX,top:k.clientY};if(j){var m=b.getClientRect(j);n.left+=m.left;n.top+=m.top}return n},setGlobal:function(k,j){f[k]=j;return g+'["'+k+'"]'},unsetGlobal:function(j){delete f[j]},copyAttributes:function(o,n){var l=n.attributes;var j=l.length;while(j--){var m=l[j];if(m.nodeName!="style"&&m.nodeName!="class"&&(!d.ie||m.specified)){o.setAttribute(m.nodeName,m.nodeValue)}}if(n.className){o.className+=" "+n.className}if(n.style.cssText){o.style.cssText+=";"+n.style.cssText}},contains:function(k,j){return k&&j&&(k===j?false:(k.contains?k.contains(j):k.compareDocumentPosition(j)&16))},startDrag:function(r,n){var p=document;var m=r.clientX;var l=r.clientY;function k(t){var s=t.clientX-m;var u=t.clientY-l;n.ondragmove(s,u);if(t.stopPropagation){t.stopPropagation()}else{t.cancelBubble=true}}if(p.addEventListener){function q(s){p.removeEventListener("mousemove",k,true);p.removeEventListener("mouseup",k,true);n.ondragstop()}p.addEventListener("mousemove",k,true);p.addEventListener("mouseup",q,true);r.preventDefault()}else{var o=r.srcElement;o.setCapture();function j(){o.releaseCapture();o.detachEvent("onmousemove",k);o.detachEvent("onmouseup",j);o.detachEvent("onlosecaptrue",j);n.ondragstop()}o.attachEvent("onmousemove",k);o.attachEvent("onmouseup",j);o.attachEvent("onlosecaptrue",j);r.returnValue=false}n.ondragstart()},getFixedLayer:function(){var j=document.getElementById("edui_fixedlayer");if(j==null){j=document.createElement("div");j.id="edui_fixedlayer";document.body.appendChild(j);if(d.ie&&d.version<=8){j.style.position="absolute";h();setTimeout(e)}else{j.style.position="fixed"}j.style.left="0";j.style.top="0";j.style.width="0";j.style.height="0"}return j},makeUnselectable:function(k){if(d.opera||(d.ie&&d.version<9)){k.unselectable="on";if(k.hasChildNodes()){for(var j=0;j<k.childNodes.length;j++){if(k.childNodes[j].nodeType==1){b.makeUnselectable(k.childNodes[j])}}}}else{if(k.style.MozUserSelect!==undefined){k.style.MozUserSelect="none"}else{if(k.style.WebkitUserSelect!==undefined){k.style.WebkitUserSelect="none"}else{if(k.style.KhtmlUserSelect!==undefined){k.style.KhtmlUserSelect="none"}}}}}};function e(){var j=document.getElementById("edui_fixedlayer");b.setViewportOffset(j,{left:0,top:0});j.style.display="none";j.style.display="block"}function h(j){c.on(window,"scroll",e)}})();(function(){var a=baidu.editor.utils,b=baidu.editor.ui.uiUtils,c=baidu.editor.EventBase,d=baidu.editor.ui.UIBase=function(){};d.prototype={className:"",uiName:"",initOptions:function(f){var g=this;for(var e in f){g[e]=f[e]}this.id=this.id||"edui"+b.uid()},initUIBase:function(){this._globalKey=a.unhtml(b.setGlobal(this.id,this))},render:function(f){var e=this.renderHtml();var g=b.createElementByHtml(e);var h=this.getDom();if(h!=null){h.parentNode.replaceChild(g,h);b.copyAttributes(g,h)}else{if(typeof f=="string"){f=document.getElementById(f)}f=f||b.getFixedLayer();f.appendChild(g)}this.postRender()},getDom:function(e){if(!e){return document.getElementById(this.id)}else{return document.getElementById(this.id+"_"+e)}},postRender:function(){},getHtmlTpl:function(){return""},formatHtml:function(e){var f="edui-"+this.uiName;return(e.replace(/##/g,this.id).replace(/%%-/g,this.uiName?f+"-":"").replace(/%%/g,(this.uiName?f:"")+" "+this.className).replace(/\$\$/g,this._globalKey))},renderHtml:function(){return this.formatHtml(this.getHtmlTpl())},dispose:function(){var e=this.getDom();if(e){domUtils.remove(e)}b.unsetGlobal(this.id)}};a.inherits(d,c)})();(function(){var c=baidu.editor.browser,a=baidu.editor.dom.domUtils,b=baidu.editor.ui.uiUtils;var d='onmousedown="$$.Stateful_onMouseDown(event, this);" onmouseup="$$.Stateful_onMouseUp(event, this);"'+(c.ie?(' onmouseenter="$$.Stateful_onMouseEnter(event, this);" onmouseleave="$$.Stateful_onMouseLeave(event, this);"'):(' onmouseover="$$.Stateful_onMouseOver(event, this);" onmouseout="$$.Stateful_onMouseOut(event, this);"'));baidu.editor.ui.Stateful={Stateful_init:function(){this._Stateful_dGetHtmlTpl=this.getHtmlTpl;this.getHtmlTpl=this.Stateful_getHtmlTpl},Stateful_getHtmlTpl:function(){var e=this._Stateful_dGetHtmlTpl();return e.replace(/stateful/g,function(){return d})},Stateful_onMouseEnter:function(e,f){if(!this.isDisabled()){this.addState("hover");this.fireEvent("over")}},Stateful_onMouseLeave:function(e,f){if(!this.isDisabled()){this.removeState("hover");this.removeState("active");this.fireEvent("out")}},Stateful_onMouseOver:function(f,g){var e=f.relatedTarget;if(!b.contains(g,e)&&g!==e){this.Stateful_onMouseEnter(f,g)}},Stateful_onMouseOut:function(f,g){var e=f.relatedTarget;if(!b.contains(g,e)&&g!==e){this.Stateful_onMouseLeave(f,g)}},Stateful_onMouseDown:function(e,f){if(!this.isDisabled()){this.addState("active")}},Stateful_onMouseUp:function(e,f){if(!this.isDisabled()){this.removeState("active")}},hasState:function(e){return a.hasClass(this.getStateDom(),"edui-state-"+e)},addState:function(e){this.getStateDom().className+=" edui-state-"+e},removeState:function(e){a.removeClasses(this.getStateDom(),["edui-state-"+e])},getStateDom:function(){return this.getDom("state")},isChecked:function(){return this.hasState("checked")},setChecked:function(e){if(e){this.addState("checked")}else{this.removeState("checked")}},isDisabled:function(){return this.hasState("disabled")},setDisabled:function(e){if(e){this.removeState("hover");this.removeState("active");this.addState("disabled")}else{this.removeState("disabled")}}}})();(function(){var a=baidu.editor.utils,c=baidu.editor.ui.UIBase,b=baidu.editor.ui.Separator=function(d){this.initOptions(d);this.initSparator()};b.prototype={uiName:"sparator",initSparator:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"></div>'}};a.inherits(b,c)})();(function(){var b=baidu.editor.utils,d=baidu.editor.browser,a=baidu.editor.dom.domUtils,e=baidu.editor.ui.UIBase,c=baidu.editor.ui.uiUtils;var f=baidu.editor.ui.Mask=function(g){this.initOptions(g);this.initUIBase()};f.prototype={getHtmlTpl:function(){return'<div id="##" class="edui-mask %%" onmousedown="return $$._onMouseDown(event, this);"></div>'},postRender:function(){var g=this;a.on(window,"resize",function(){if(!g.isHidden()){g._fill()}})},show:function(){this._fill();this.getDom().style.display=""},hide:function(){this.getDom().style.display="none"},isHidden:function(){return this.getDom().style.display=="none"},_onMouseDown:function(){return false},_fill:function(){var g=this.getDom();var h=c.getViewportRect();g.style.width=h.width+"px";g.style.height=h.height+"px"}};b.inherits(f,e)})();(function(){var c=baidu.editor.utils,e=baidu.editor.ui.uiUtils,a=baidu.editor.dom.domUtils,h=baidu.editor.ui.UIBase,g=baidu.editor.ui.Popup=function(i){this.initOptions(i);this.initPopup()};var b=[];function f(l){var m=[];for(var k=0;k<b.length;k++){var j=b[k];if(!j.isHidden()){if(j.queryAutoHide(l)!==false){j.hide()}}}}g.postHide=f;var d=["edui-anchor-topleft","edui-anchor-topright","edui-anchor-bottomleft","edui-anchor-bottomright"];g.prototype={SHADOW_RADIUS:5,content:null,_hidden:false,initPopup:function(){this.initUIBase();b.push(this)},getHtmlTpl:function(){return'<div id="##" class="edui-popup %%"> <div id="##_body" class="edui-popup-body" onmousedown="return false;">  <div class="edui-shadow"></div>  <div id="##_content" class="edui-box edui-popup-content">'+this.getContentHtmlTpl()+"  </div> </div></div>"},getContentHtmlTpl:function(){if(typeof this.content=="string"){return this.content}return this.content.renderHtml()},postRender:function(){if(this.content instanceof h){this.content.postRender()}this.hide()},mesureSize:function(){var i=this.getDom("content");return e.getClientRect(i)},fitSize:function(){var i=this.getDom("body");i.style.width="";i.style.height="";var j=this.mesureSize();i.style.width=j.width+"px";i.style.height=j.height+"px";return j},showAnchor:function(j,i){this.showAnchorRect(e.getClientRect(j),i)},showAnchorRect:function(o,m){var k=e.getViewportRect();var j=this.fitSize();var p,l,i,n;if(m){p=(o.right+j.width>k.right&&o.left>j.width);l=(o.top+j.height>k.bottom&&o.bottom>j.height);i=(p?o.left-j.width:o.right);n=(l?o.bottom-j.height:o.top)}else{p=(o.right+j.width>k.right&&o.left>j.width);l=(o.bottom+j.height>k.bottom&&o.top>j.height);i=(p?o.right-j.width:o.left);n=(l?o.top-j.height:o.bottom)}var q=this.getDom();e.setViewportOffset(q,{left:i,top:n});a.removeClasses(q,d);q.className+=" "+d[(l?1:0)*2+(p?1:0)];this._show()},showAt:function(l){var k=l.left;var j=l.top;var i={left:k,top:j,right:k,bottom:j,height:0,width:0};this.showAnchorRect(i)},_show:function(){if(this._hidden){var i=this.getDom();i.style.visibility="visible";this._hidden=false;this.fireEvent("show")}},isHidden:function(){return this._hidden},show:function(){this._show()},hide:function(){if(!this._hidden){this.getDom().style.left="-32768px";this.getDom().style.top="-32768px";this._hidden=true;this.fireEvent("hide")}},queryAutoHide:function(i){return !i||!e.contains(this.getDom(),i)}};c.inherits(g,h);a.on(document,"mousedown",function(i){var j=i.target||i.srcElement;f(j)});a.on(window,"scroll",function(){f()})})();(function(){var b=baidu.editor.utils,d=baidu.editor.ui.UIBase,c=baidu.editor.ui.Stateful,a=baidu.editor.ui.Button=function(e){this.initOptions(e);this.initButton()};a.prototype={uiName:"button",label:"",title:"",initButton:function(){this.initUIBase();this.Stateful_init()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div id="##_state" stateful><div class="%%-wrap"><div id="##_body" unselectable="on" '+(this.title?'title="'+this.title+'"':"")+' class="%%-body" onmousedown="return false;" onclick="return $$._onClick();">'+this.label+"</div></div></div></div>"},_onClick:function(){if(!this.isDisabled()){this.fireEvent("click")}}};b.inherits(a,d);b.extend(a.prototype,c)})();(function(){var c=baidu.editor.utils,a=baidu.editor.dom.domUtils,e=baidu.editor.ui.uiUtils,g=baidu.editor.ui.UIBase,d=baidu.editor.ui.Stateful,f=baidu.editor.ui.Popup,h=baidu.editor.ui.Mask,b=baidu.editor.ui.SplitButton=function(i){this.initOptions(i);this.initSplitButton()};b.prototype={popup:null,uiName:"splitbutton",title:"",initSplitButton:function(){this.initUIBase();this.Stateful_init();var i=this},postRender:function(){this.popup.className=this.className;this.popup.render();this.popup.addListener("show",c.bind(this._onPopupShow,this));this.popup.addListener("hide",c.bind(this._onPopupHide,this));this.popup.getDom("body").appendChild(e.createElementByHtml('<div id="'+this.popup.id+'_bordereraser" class="edui-bordereraser edui-background" style="width:'+(e.getClientRect(this.getDom()).width-2)+'px"></div>'))},_onPopupShow:function(){this.addState("opened")},_onPopupHide:function(){this.removeState("opened")},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div '+(this.title?'title="'+this.title+'"':"")+' id="##_state" stateful><div class="%%-body"><div id="##_button_body" class="edui-box edui-button-body" onclick="$$._onButtonClick(event, this);"></div><div class="edui-box edui-arrow" onclick="$$._onArrowClick();"></div></div></div></div>'},showPopup:function(){var i=e.getClientRect(this.getDom());i.top-=this.popup.SHADOW_RADIUS;i.height+=this.popup.SHADOW_RADIUS;this.popup.showAnchorRect(i)},_onArrowClick:function(j,i){if(!this.isDisabled()){this.showPopup()}},_onButtonClick:function(){if(!this.isDisabled()){this.fireEvent("buttonclick")}}};c.inherits(b,g);c.extend(b.prototype,d,true)})();(function(){var a=baidu.editor.utils,b=baidu.editor.ui.uiUtils,d=baidu.editor.ui.UIBase,c=baidu.editor.ui.Toolbar=function(e){this.initOptions(e);this.initToolbar()};c.prototype={items:null,initToolbar:function(){this.items=this.items||[];this.initUIBase()},add:function(e){this.items.push(e)},getHtmlTpl:function(){var f=[];for(var e=0;e<this.items.length;e++){f[e]=this.items[e].renderHtml()}return'<div id="##" class="edui-toolbar %%" onselectstart="return false;" onmousedown="return $$._onMouseDown(event, this);">'+f.join("")+"</div>"},postRender:function(){var f=this.getDom();for(var e=0;e<this.items.length;e++){this.items[e].postRender()}b.makeUnselectable(f)},_onMouseDown:function(){return false}};a.inherits(c,d)})();(function(){var b=baidu.editor.utils,a=baidu.editor.dom.domUtils,d=baidu.editor.ui.uiUtils,h=baidu.editor.ui.UIBase,g=baidu.editor.ui.Popup,c=baidu.editor.ui.Stateful,f=baidu.editor.ui.Menu=function(i){this.initOptions(i);this.initMenu()};f.prototype={items:null,uiName:"menu",initMenu:function(){this.items=this.items||[];this.initPopup();this.initItems()},initItems:function(){for(var j=0;j<this.items.length;j++){var k=this.items[j];if(!(k instanceof e)){this.items[j]=this.createItem(k)}}},createItem:function(i){return new e(i)},getContentHtmlTpl:function(){var l=[];for(var j=0;j<this.items.length;j++){var k=this.items[j];l[j]=k.renderHtml()}return('<ul class="edui-box %%-body">'+l.join("")+"</ul>")},_Popup_postRender:g.prototype.postRender,postRender:function(){var l=this;for(var j=0;j<this.items.length;j++){var k=this.items[j];k.ownerMenu=this;k.postRender()}a.on(this.getDom(),"mouseover",function(m){m=m||event;var i=m.relatedTarget||m.fromElement;var n=l.getDom();if(!d.contains(n,i)&&n!==i){l.fireEvent("over")}});this._Popup_postRender()},queryAutoHide:function(k){if(k){if(d.contains(this.getDom(),k)){return false}for(var j=0;j<this.items.length;j++){var l=this.items[j];if(l.queryAutoHide(k)===false){return false}}}}};b.inherits(f,g);var e=baidu.editor.ui.MenuItem=function(i){this.initOptions(i);this.initUIBase();this.Stateful_init();if(this.subMenu&&!(this.subMenu instanceof f)){this.subMenu=new f(this.subMenu)}};e.prototype={label:"",subMenu:null,ownerMenu:null,uiName:"menuitem",getHtmlTpl:function(){return'<li id="##" class="edui-box %%" stateful onclick="$$._onClick(event, this);"><div class="%%-body">'+this.renderLabelHtml()+"</div></li>"},postRender:function(){if(this.subMenu){this.getDom().className+=" edui-hassubmenu";this.subMenu.render();var i=this;this.addListener("over",function(){if(!i.isDisabled()){i.addState("opened");i.showSubMenu()}});this.addListener("out",function(){if(!i.isDisabled()){i.removeState("opened");i._closingTimer=setTimeout(function(){if(!i.hasState("opened")){i.hideSubMenu()}},250)}});this.subMenu.addListener("over",function(){clearTimeout(i._closingTimer);i.addState("opened")});this.ownerMenu.addListener("hide",function(){i.hideSubMenu()})}this.getDom().style.tabIndex="-1";d.makeUnselectable(this.getDom())},renderLabelHtml:function(){return'<div class="edui-label %%-label">'+(this.label||"")+"</div>"},getStateDom:function(){return this.getDom()},queryAutoHide:function(i){if(this.subMenu&&this.hasState("opened")){return this.subMenu.queryAutoHide(i)}},_onClick:function(i,j){if(this.fireEvent("click",i,j)!==false){if(this.subMenu){this.showSubMenu()}else{g.postHide()}}},showSubMenu:function(){var i=d.getClientRect(this.getDom());i.right-=5;i.left+=2;i.width-=7;i.top-=4;i.bottom+=4;i.height+=8;this.subMenu.showAnchorRect(i,true)},hideSubMenu:function(){this.subMenu.hide()}};b.inherits(e,h);b.extend(e.prototype,c,true)})();